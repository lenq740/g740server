<form name="%form%" caption="Описание структуры базы данных">
	<rowsets>
		<rowset name="treedatamodel">
			<rowset name="systable" parent.row.type="systablecategory" parent.sync.row.type="systable">
				<param name="filter.klssystablecategory" js_value="get('#parent[systablecategory].id')"/>
			</rowset>
			<rowset name="sysfield" parent.row.type="systable" parent.sync.row.type="sysfield">
				<param name="filter.klssystable" js_value="get('#parent[systable].id')"/>
				<rowset name="sysfield-params" datasource="sysfieldparams">
					<param name="filter.klssysfield" js_value="get('#parent.id')"/>
				</rowset>
			</rowset>
			<rowset name="sysfieldparams" parent.row.type="sysfield">
				<param name="filter.klssysfield" js_value="get('#parent[sysfield].id')"/>
			</rowset>
		</rowset>
	</rowsets>
	<panels>
		<panel type="panel">
			<toolbar default="1">
				<request caption="Экспорт таблиц" icon="backup" style="icontext" enabled="%permEnabledSysWrite%">
					<request name="form" form="formUtils" caption="Экспорт всех таблиц" icon="backup" enabled="%permEnabledSysWrite%">
						<param name="mode" value="backup"></param>
						<param name="isall" value="1"></param>
					</request>
					<separator/>
					<request name="form" form="formUtils" caption="Экспорт описателей структуры базы" icon="backup" enabled="%permEnabledSysWrite%">
						<param name="mode" value="backup"></param>
						<param name="isdatastru" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Экспорт системных справочников" icon="backup" enabled="%permEnabledSysWrite%">
						<param name="mode" value="backup"></param>
						<param name="issystem" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Экспорт статических таблиц" icon="backup" enabled="%permEnabledSysWrite%">
						<param name="mode" value="backup"></param>
						<param name="isstatic" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Экспорт динамических таблиц" icon="backup" enabled="%permEnabledSysWrite%">
						<param name="mode" value="backup"></param>
						<param name="isdynamic" value="1"></param>
					</request>
				</request>
				<request caption="Импорт таблиц" icon="restore" style="icontext" enabled="%permEnabledSysWrite%">
					<request name="form" form="formUtils" caption="Импорт описателей структуры базы" icon="restore" enabled="%permEnabledSysWrite%">
						<param name="mode" value="restore"></param>
						<param name="isdatastru" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Импорт системных справочников" icon="restore" enabled="%permEnabledSysWrite%">
						<param name="mode" value="restore"></param>
						<param name="issystem" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Импорт татических таблиц" icon="restore" enabled="%permEnabledSysWrite%">
						<param name="mode" value="restore"></param>
						<param name="isstatic" value="1"></param>
					</request>
					<request name="form" form="formUtils" caption="Импорт динамических таблиц" icon="restore" enabled="%permEnabledSysWrite%">
						<param name="mode" value="restore"></param>
						<param name="isdynamic" value="1"></param>
					</request>
					<separator/>
					<request name="form" form="formUtils" caption="Импорт всех таблиц" icon="restore" enabled="%permEnabledSysWrite%">
						<param name="mode" value="restore"></param>
						<param name="isall" value="1"></param>
					</request>
				</request>
				<separator/>
				<request caption="Генератор объектов" icon="config" style="icontext" enabled="%permEnabledSysWrite%">
					<request name="form" form="formUtils" caption="Генератор классов DataSource" icon="config" enabled="%permEnabledSysWrite%">
						<param name="mode" value="autogendatasources"></param>
					</request>
				</request>
			</toolbar>
			<panel type="tree" rowset="treedatamodel" caption="Структура базы данных" align="left" width="20%" splitter="1" focus="1" border="1"/>
			<panel type="panel" rowset="treedatamodel" border="1">
				<panel type="tab" bestchild="1">
					<panel type="panel" row.type="systablecategory">
						<panel type="fields" align="top" caption="Анкета категории" border="1" padding="10px">
							<field field="name" stretch="1" caption="Категория"/>
						</panel>
						<panel type="grid" rowset="systable" caption="Список таблиц в категории">
							<fields>
								<field name="tablename"/>
								<field name="name"/>
								<field name="permmode"/>
								<field name="issystem" caption="Систем" len="6"/>
								<field name="isstatic" caption="Статич" len="6"/>
								<field name="isdynamic" caption="Динам" len="6"/>
							</fields>
						</panel>
						<panel type="memo" rowset="systable" caption="Сортировка" align="bottom" border="1" field="orderby" height="100px"/>
						<panel type="memo" rowset="systable" caption="Поля" align="bottom" border="1" field="fields" height="100px"/>
					</panel>
					<panel type="panel" row.type="systable">
						<panel align="top" height="110px">
							<panel type="fields" row.type="systable" caption="Анкета таблицы" border="1" padding="10px">
								<field name="tablename" stretch="1" len="5"/>
								<field name="name" stretch="1" len="5"/>
								<field name="permmode" stretch="1" len="5"/>
							</panel>
							<panel type="fields" caption="Дополн" align="right" width="80px" border="1" padding="10px">
								<field name="issystem" caption="Систем" len="6"/>
								<field name="isstatic" caption="Статич" len="6"/>
								<field name="isdynamic" caption="Динам" len="6"/>
							</panel>
							<panel type="memo" caption="Сортировка" align="right" width="280px" border="1" field="orderby"/>
							<panel type="memo" caption="Поля" align="right" width="280px" border="1" field="fields"/>
						</panel>
						<panel type="grid" rowset="sysfield" caption="Поля таблицы" border="1">
							<fields>
								<field name="fieldname" len="15"/>
								<field name="name" len="15"/>
								<field name="ismain" len="4" caption="Main"/>
								<field name="sysfieldtype_name" len="7"/>
								<field name="maxlength" len="3" caption="Max"/>
								<field name="len" len="3" caption="Len"/>
								<field name="dec" len="3" caption="Dec"/>
								<field name="isstretch" len="5"/>
								<field name="isnotempty" len="5" caption="NoNul"/>
								<field name="reflink" len="8"/>
								<field name="reftable_tablename" len="12"/>
								<field name="isrefrestrict" len="4" caption="Rstr"/>
								<field name="isrefcascade" len="4" caption="Cscd"/>
								<field name="isrefclear" len="4" caption="Clr"/>
								<field name="isref121" len="4" caption="1"/>
								<field name="mysql_type"/>
								<field name="mysql_length" caption="Длина"/>
							</fields>
						</panel>
						<panel type="grid" rowset="sysfield-params" caption="Параметры поля" height="20%" splitter="1" align="bottom" border="1">
							<field name="name"/>
							<field name="val"/>
						</panel>
					</panel>
					<panel type="panel" row.type="sysfield">
						<panel type="fields" align="top" row.type="sysfield" caption="Анкета поля" captionup="1" padding="10px" border="1">
							<field name="fieldname" line="field"/>
							<field name="name" line="field"/>
							<field name="sysfieldtype_name" line="field"/>
							<field name="ismain" line="field"/>
							
							<field name="maxlength" caption="max" line="attr"/>
							<field name="len" caption="len" line="attr"/>
							<field name="dec" caption="dec" line="attr"/>
							<field name="isstretch" line="attr"/>
							<field name="isnotempty" line="attr"/>
							
							<field name="reflink" line="is"/>
							<field name="reftable_tablename" line="is"/>
							<field name="isrefrestrict" caption="restrict" len="6" line="is"/>
							<field name="isrefcascade" caption="cascade" len="6" line="is"/>
							<field name="isrefclear" caption="clear" len="6" line="is"/>
							<field name="isref121" caption="1 к 1" len="6" line="is"/>
						</panel>
						<panel type="grid" rowset="sysfieldparams" caption="Параметры поля" border="1">
							<field name="name"/>
							<field name="val"/>
						</panel>
					</panel>
				</panel>
			</panel>
		</panel>
	</panels>
</form>
